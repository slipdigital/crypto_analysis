{% extends "base.html" %}

{% block title %}Edit {{ ticker.ticker }} - Market Cap{% endblock %}

{% block content %}
<div class="mb-3">
    <a href="/" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Back to All Tickers
    </a>
</div>

{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        {% endfor %}
    {% endif %}
{% endwith %}

<div class="card">
    <div class="card-header bg-primary text-white">
        <h2 class="mb-0">
            <i class="bi bi-pencil-square"></i> Edit Market Cap for {{ ticker.ticker }}
        </h2>
    </div>
    
    <div class="card-body">
        <form method="POST">
            <div class="row mb-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title text-muted">Ticker Information</h5>
                            <p class="mb-1"><strong>Ticker:</strong> {{ ticker.ticker }}</p>
                            <p class="mb-1"><strong>Name:</strong> {{ ticker.name or 'N/A' }}</p>
                            <p class="mb-1"><strong>Crypto Symbol:</strong> 
                                {% if ticker.crypto_symbol %}
                                <span class="badge bg-warning text-dark">{{ ticker.crypto_symbol }}</span>
                                {% else %}
                                N/A
                                {% endif %}
                            </p>
                            <p class="mb-0"><strong>Current Market Cap:</strong> 
                                {% if ticker.market_cap %}
                                <span class="text-success">${{ "{:,.2f}".format(ticker.market_cap) }}</span>
                                {% else %}
                                <span class="text-muted">Not set</span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-3">
                <label for="market_cap" class="form-label">
                    <strong>Market Cap (USD)</strong>
                </label>
                <input type="number" 
                       step="0.01" 
                       class="form-control form-control-lg" 
                       id="market_cap" 
                       name="market_cap" 
                       value="{{ ticker.market_cap if ticker.market_cap else '' }}"
                       placeholder="Enter market cap value (e.g., 1000000000.50)">
                <div class="form-text">
                    Enter the market capitalization in USD. Leave blank to clear the value.
                </div>
            </div>
            
            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary btn-lg">
                    <i class="bi bi-check-circle"></i> Save Market Cap
                </button>
                <a href="/" class="btn btn-secondary btn-lg">
                    <i class="bi bi-x-circle"></i> Cancel
                </a>
            </div>
        </form>
    </div>
</div>

<div class="alert alert-info mt-4">
    <i class="bi bi-info-circle"></i> <strong>Note:</strong> Only the market cap field can be edited. All other ticker information is managed automatically.
</div>
{% endblock %}
